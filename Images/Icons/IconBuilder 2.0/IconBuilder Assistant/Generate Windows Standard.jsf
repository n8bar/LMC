// save interpolation preferencevar saveInterpolation = App.getPref("EditTransformMode");//alert("saved EditTransformMode as " + saveInterpolation);// select all pixelsfw.getDocumentDOM().setSelectionMask(null, "replace");fw.getDocumentDOM().selectAll();// clear everything except 48x48 iconsfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().setSelectionMask({maskBounds:{left:22, top:101, right:70, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:87, top:101, right:135, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "add");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:152, top:101, right:200, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "add");fw.getDocumentDOM().selectInverse();fw.getDocumentDOM().deleteSelection(false);// copy 48x48 icon in first columnfw.getDocumentDOM().setSelectionMask({maskBounds:{left:22, top:101, right:70, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().clipCopy();// change interpolation to bicubicApp.setPref("EditTransformMode", 1);// alert("set EditTransformMode to 1");// paste and scale to create create 32x32 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:22, top:101, right:70, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.66, 0.66, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-8, y:57}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:22, top:101, right:70, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.5, 0.5, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-12, y:102}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:22, top:101, right:70, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.33, 0.33, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-16, y:139}, false, true);fw.getDocumentDOM().mergeDown();// copy 48x48 icon in second columnfw.getDocumentDOM().setSelectionMask({maskBounds:{left:87, top:101, right:135, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().clipCopy();// change interpolation to nearest neighborApp.setPref("EditTransformMode", 4);//alert("set EditTransformMode to 4");// paste and scale to create create 32x32 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:87, top:101, right:135, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.66, 0.66, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-8, y:57}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:87, top:101, right:135, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.5, 0.5, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-12, y:102}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:87, top:101, right:135, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.33, 0.33, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-16, y:139}, false, true);fw.getDocumentDOM().mergeDown();// copy 48x48 icon in third columnfw.getDocumentDOM().setSelectionMask({maskBounds:{left:152, top:101, right:200, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().clipCopy();// keep interpolation as nearest neighbor// paste and scale to create create 32x32 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:152, top:101, right:200, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.66, 0.66, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-8, y:57}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:152, top:101, right:200, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.5, 0.5, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-12, y:102}, false, true);fw.getDocumentDOM().mergeDown();// paste and scale to create create 24x24 iconfw.getDocumentDOM().enterPaintMode(null);fw.getDocumentDOM().clipPaste("ask user", "vector");fw.getDocumentDOM().setSelectionMask({maskBounds:{left:152, top:101, right:200, bottom:149}, maskKind:"rectangle", maskEdgeMode:"hard edge", featherAmount:0, maskData:null}, "replace");fw.getDocumentDOM().scaleSelection(0.33, 0.33, "autoTrimImages transformAttributes");fw.getDocumentDOM().exitPaintMode();fw.getDocumentDOM().moveSelectionBy({x:-16, y:139}, false, true);fw.getDocumentDOM().mergeDown();// restore interpolation preferenceApp.setPref("EditTransformMode", saveInterpolation);//alert("restored EditTransformMode to " + saveInterpolation);